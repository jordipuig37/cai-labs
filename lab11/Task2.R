library(igraph)
# Erdos-Renyi model
eps <- 0.3
avg <- c()
N.plot <- c()

# Execute to add more points
N <- 25000
for (n in N){
  p <- (1+eps) / sqrt(n)
  er <- erdos.renyi.game(n, p)
  if (count_components(er) == 1){
    avg <- c(avg, average.path.length(er))
    N.plot <- c(N.plot, n)
  }
}

avg2 <- c(2.85353535353535, 2.77767741935484,2.79851648794646,3.02237450199203,3.07606992163954,3.10050251256281,3.21911377245509,3.27305624952684,3.40789845658326,3.37651451451451,3.46946764256886,3.52687248352125,3.56912341033124,3.64513526935666,3.70047089158448,3.79860012563179,3.86384233532976,3.9161691367285,4.02951318357811,4.08961093504338,4.14512558072812,4.21884087447258,4.27419515996883,4.33105194990077,4.39458872750394,4.45043329111449)
N.plot2 <- c(100.0000, 125.8925, 158.4893, 251.1886, 316.2278, 398.1072, 501.1872, 630.9573, 794.3282, 1000.0000, 1258.9254, 1584.8932, 1995.262, 2511.8864  3162.2777  5011.8723  6309.5734  7943.2823, 12589.2541, 15848.9319, 19952.6231, 25118.8643, 31622.7766, 39810.7171,50118.7234, 63095.7344)

# Plot results
lo <- lm(avg~log(N.plot))
plot(N.plot, predict(lo), col='#cb3700', lwd=2, type="l", xlab='Num Nodes', 
     ylab='Average Shortest Path')
points(N.plot, avg, type="b")

